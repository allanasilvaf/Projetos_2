def obter_dados_materia(nome_fixo=None):

    tabela_conceitos = {'E': 10.0, 'B': 7.5, 'R': 5.0, 'I': 0.0, 'SF': 0.0}

    if nome_fixo:
        nome = nome_fixo
        print(f"Editando a matéria: {nome}")
    else:
        while True:
            nome = input("Digite o nome da disciplina: ").strip()
            if nome:
                break
            print(">> Erro: O nome não pode ficar vazio.")
    while True:
        conceito = input(f"Conceito para {nome} (E, B, R, I ou SF): ").upper().strip()
        if conceito in tabela_conceitos:
            valor_nota = tabela_conceitos[conceito]
            break
        print(">> Erro: Entrada inválida. Digite apenas E, B, R, I ou SF.")
    while True:
        try:
            horas = int(input(f"Carga horária para {nome}: "))
            if horas > 0:
                break
            print(">> Erro: A carga horária deve ser maior que zero.")
        except ValueError:
            print(">> Erro: Digite um número inteiro válido (ex: 60).")
    return {
        'nome': nome,
        'conceito': conceito,
        'valor': valor_nota,
        'horas': horas
    }

def calcular_crg():
    print("Calculadora de CRG:")
    lista_materias = []
    while True:
        print("\nNova Matéria:")
        materia = obter_dados_materia()
        lista_materias.append(materia)

        if input("Adicionar outra? (S/N): ").upper().strip() != 'S':
            break
    while True:

        editar = input("\nDeseja alterar alguma matéria? (S/N): ").upper().strip()

        if editar == 'S':
            codigo_para_editar = input("Digite o CÓDIGO da matéria que quer corrigir: ").strip()

            encontrada = False
            for i, mat in enumerate(lista_materias):
                if mat['nome'] == nome_para_editar:
                    lista_materias[i] = obter_dados_materia(nome_fixo=codigo_para_editar)
                    encontrada = True
                    print("Alteração realizada com sucesso!")
                    break

            if not encontrada:
                print(f">> Matéria '{nome_para_editar}' não encontrada.")
        else:
            break

    soma_ponderada = 0.0
    total_horas = 0

    for mat in lista_materias:
        soma_ponderada += (mat['valor'] * mat['horas'])
        total_horas += mat['horas']

    if total_horas > 0:
        crg = soma_ponderada / total_horas
        print(f"Total de Matérias: {len(lista_materias)}")
        print(f"Carga Horária Total: {total_horas}h")
        print(f"CRG FINAL: {crg:.2f}")
    else:
        print("Nenhuma matéria válida para calcular.")

if __name__ == "__main__":
    calcular_crg()
